<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aim Trainer</title>

    <!-- Cargar las fuentes Orbitron y Roboto desde Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">

    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #0f2d3e;
            font-family: 'Roboto', sans-serif; /* Tipografía más cerrada para el resto del código */
        }
        #game {
            position: relative;
            width: 100vw;
            height: 100vh;
            background-color: #0f2d3e;
        }
        .target {
            position: absolute;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .ring1 {
            background-color: #f94144; 
            border-radius: 50%;
            width: 20%;
            height: 20%;
        }

        .ring2 {
            background-color: white;
            border-radius: 50%;
            width: 50%;
            height: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .ring3 {
            background-color: #f94144;
            border-radius: 50%;
            width: 80%;
            height: 80%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #timer, #score {
            font-family: 'Orbitron', sans-serif; /* Tipografía futurista para el temporizador y aciertos */
            position: absolute;
            font-size: 30px;
            color: white;
        }

        #timer {
            top: 20px;
            right: 20px;
        }

        #score {
            top: 20px;
            left: 20px;
        }

        #lives {
            position: absolute;
            top: 20px;
            left: 250px; /* Mover los corazones un poco más a la derecha */
            display: flex;
            gap: 30px;
        }

        .heart {
            width: 30px;
            height: 30px;
            background-color: #f94144;
            position: relative;
            display: inline-block;
            margin-right: 5px;
            transform: rotate(-45deg);
        }

        .heart::before,
        .heart::after {
            content: "";
            position: absolute;
            background-color: #f94144;
            border-radius: 50%;
        }

        .heart::before {
            width: 30px;
            height: 30px;
            top: -15px;
            left: 0;
        }

        .heart::after {
            width: 30px;
            height: 30px;
            left: 15px;
            top: 0;
        }

        #startButton {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 20px;
            padding: 10px 20px;
            background-color: #807A15; 
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 10px; /*Bordes redondeados */
        }

        #startButton:hover {
            background-color: #76710d; 
        }

        .modal {
            display: none; /* Hidden by default */
            position: fixed; 
            z-index: 1; 
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4); /* Black w/ opacity */
        }

        .modal-content {
            background-color: white;
            margin: 15% auto; 
            padding: 20px;
            border: 1px solid #888;
            width: 30%;
            text-align: center;
            font-size: 20px;
            border-radius: 15px; /*Bordes redondeados*/
        }

        .modal button {
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #807A15; 
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 10px; /* Bordes redondeados */
        }

        .modal button:hover {
            background-color: #76710d; 
        }
    </style>
</head>
<body>
    <div id="game"></div>
    <div id="timer" style="display:none;">60</div> <!-- Temporizador oculto hasta que inicie el juego -->
    <div id="score">Aciertos: 0</div> <!-- Contador de aciertos -->
    <div id="lives">
        <div class="heart"></div>
        <div class="heart"></div>
        <div class="heart"></div>
    </div> <!-- Mostrar 3 corazones personalizados -->
    <button id="startButton">Iniciar Juego</button> <!-- Botón de inicio -->

    <!-- Modal personalizado -->
    <div id="endGameModal" class="modal">
        <div class="modal-content">
            <p id="finalScore"></p>
            <button id="restartButton">Reiniciar</button>
        </div>
    </div>

    <script>
        const game = document.getElementById('game');
        const timerDisplay = document.getElementById('timer');
        const scoreDisplay = document.getElementById('score');
        const livesDisplay = document.getElementById('lives');
        const startButton = document.getElementById('startButton');
        const endGameModal = document.getElementById('endGameModal');
        const finalScoreText = document.getElementById('finalScore');
        const restartButton = document.getElementById('restartButton');
        let timeLeft = 60; // Tiempo en segundos
        const targetSize = [80, 100, 120]; 
        let gameInterval, timerInterval;
        let score = 0; // Inicializamos el contador de aciertos
        let totalTargets = 0; // Contador de dianas creadas
        let lives = 3; // Inicializamos las vidas a 3

        // Áreas de interfaz de usuario que queremos evitar
        const uiAreas = [
            { x: 20, y: 20, width: 150, height: 50 },  // Área del temporizador
            { x: 20, y: 20, width: 150, height: 50 },  // Área del score
            { x: 250, y: 20, width: 150, height: 50 }  // Área de los corazones
        ];

        function isInsideUI(x, y, size) {
            return uiAreas.some(area => {
                return (
                    x < area.x + area.width &&
                    x + size > area.x &&
                    y < area.y + area.height &&
                    y + size > area.y
                );
            });
        }

        function createTarget() {
            let x, y, size;

            do {
                size = targetSize[Math.floor(Math.random() * targetSize.length)];
                x = Math.random() * (window.innerWidth - size);
                y = Math.random() * (window.innerHeight - size);
            } while (isInsideUI(x, y, size)); // Verifica si está en las áreas prohibidas

            const target = document.createElement('div');
            target.classList.add('target');
            target.style.width = `${size}px`;
            target.style.height = `${size}px`;
            target.style.left = `${x}px`;
            target.style.top = `${y}px`;

            const ring1 = document.createElement('div');
            ring1.classList.add('ring1');

            const ring2 = document.createElement('div');
            ring2.classList.add('ring2');

            const ring3 = document.createElement('div');
            ring3.classList.add('ring3');

            ring2.appendChild(ring1);
            ring3.appendChild(ring2);
            target.appendChild(ring3); 

            target.addEventListener('click', () => {
                score++; // Incrementa el contador de aciertos
                scoreDisplay.textContent = `Aciertos: ${score}`; // Actualiza el contador en pantalla
                target.remove(); // Elimina la diana clickeada
            });

            game.appendChild(target);
            totalTargets++; // Incrementar el total de dianas creadas

            setTimeout(() => {
                if (document.body.contains(target)) {
                    target.remove();
                    loseLife(); // Si no se hace clic en la diana, pierdes una vida
                }
            }, 1500); 
        }

        function loseLife() {
            lives--; // Restar una vida
            updateLivesDisplay(); // Actualizar el display de corazones
            if (lives <= 0) {
                endGame(); // Si te quedas sin vidas, termina el juego
            }
        }

        function updateLivesDisplay() {
            // Actualizar la cantidad de corazones visibles según las vidas restantes
            const hearts = livesDisplay.querySelectorAll('.heart');
            hearts.forEach((heart, index) => {
                if (index >= lives) {
                    heart.style.visibility = 'hidden';
                } else {
                    heart.style.visibility = 'visible';
                }
            });
        }

        function startGame() {
            startButton.style.display = 'none'; // Ocultar el botón de inicio
            timerDisplay.style.display = 'block'; // Mostrar el temporizador
            timeLeft = 60; // Reiniciar el tiempo
            timerDisplay.textContent = timeLeft;
            score = 0; // Reiniciar el contador de aciertos
            totalTargets = 0; // Reiniciar el total de dianas creadas
            lives = 3; // Reiniciar las vidas
            scoreDisplay.textContent = `Aciertos: ${score}`; // Mostrar aciertos reiniciados
            updateLivesDisplay(); // Mostrar vidas reiniciadas

            // Iniciar la creación de objetivos cada 2 segundos (2000 milisegundos)
            gameInterval = setInterval(createTarget, 2000);

            // Iniciar el temporizador
            timerInterval = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = timeLeft;

                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
        }

        function endGame() {
            clearInterval(gameInterval);
            clearInterval(timerInterval);

            // Calcular precisión
            let precision = ((score / totalTargets) * 100).toFixed(2);

            // Mostrar el mensaje final con aciertos, tiempo y precisión
            finalScoreText.innerHTML = `El juego ha terminado<br>
                                        Aciertos: ${score}<br>
                                        Tiempo: ${60 - timeLeft} segundos<br>
                                        Precisión: ${precision}%`;
            endGameModal.style.display = "block"; // Mostrar modal
        }

        restartButton.addEventListener('click', () => {
            endGameModal.style.display = "none"; // Ocultar modal
            startGame(); // Reiniciar juego
        });

        // Evento para iniciar el juego cuando se presiona el botón
        startButton.addEventListener('click', startGame);
    </script>
</body>
</html>
